<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Catálogo | TecnoPlus</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet" />
  <style>
    .card-product:hover { transform: translateY(-4px); box-shadow: 0 1rem 2rem rgba(0,0,0,.08) }
    .rating i { color: #f59f00 }
    .badge-new { background: linear-gradient(135deg, #6f42c1, #a98eda) }
    .badge-off { background: linear-gradient(135deg, #dc3545, #fd7e14) }
  </style>
</head>
<body class="bg-light">
<nav class="navbar navbar-expand-lg bg-white border-bottom sticky-top">
    <div class="container">
      <a class="navbar-brand d-flex align-items-center" href="#">
        <i class="bi bi-cpu me-2 fs-4 text-primary"></i>
        <span>TecnoPlus</span>
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbars" aria-controls="navbars" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbars">
        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
          <li class="nav-item"><a class="nav-link active" href="COMPUPRObetaaaa.html">Inicio</a></li>
          <li class="nav-item"><a class="nav-link" href="CATALOGO98.html">Catálogo</a></li>
          <li class="nav-item"><a class="nav-link" href="COMPUPROOFERTAS.html">Ofertas</a></li>
          <li class="nav-item"><a class="nav-link" href="COMPUPROCONTACTO.html">Contacto</a></li>
          <li class="nav-item"><a class="nav-link" href="COMPUPROFAQ.html">FAQ</a></li>
        </ul>
        <form class="d-flex me-2" role="search" onsubmit="event.preventDefault()">
          <input id="searchInput" class="form-control" type="search" placeholder="Buscar productos..." aria-label="Buscar">
        </form>
        <button class="btn btn-outline-primary me-2" data-bs-toggle="offcanvas" data-bs-target="#filtersCanvas" aria-controls="filtersCanvas">
          <i class="bi bi-sliders"></i>
        </button>
        <button class="btn btn-primary position-relative" data-bs-toggle="offcanvas" data-bs-target="#cartCanvas" aria-controls="cartCanvas">
          <i class="bi bi-bag"></i>
          <span id="cartCount" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">0</span>
        </button>
      </div>
    </div>
  </nav>
<div class="offcanvas offcanvas-end" tabindex="-1" id="cartCanvas" aria-labelledby="cartCanvasLabel">
  <div class="offcanvas-header">
    <h5 class="offcanvas-title" id="cartCanvasLabel">🛒 Tu Carrito</h5>
    <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
  </div>
  <div class="offcanvas-body d-flex flex-column">
    <div id="cartItemsContainer" class="flex-grow-1 overflow-auto">
      </div>
    <div class="mt-auto pt-3 border-top">
      <div class="d-flex justify-content-between fw-bold fs-5">
        <span>Total:</span>
        <span id="cartTotal"></span>
      </div>
      <button id="clearCartBtn" class="btn btn-danger w-100 mt-3">
        <i class="bi bi-trash"></i> Vaciar Carrito
      </button>
    </div>
  </div>
</div>
<section id="catalogo" class="py-5">
  <div class="container">

    <div id="cartBarContainer"></div>

    <div class="d-flex justify-content-between align-items-center mb-3">
      <h2 class="fw-semibold mb-0">Catálogo destacado</h2>
      <div class="text-muted">Resultados: <span id="resultsCount">0</span></div>
    </div>

    <div id="productsGrid" class="row g-4"></div>

    <nav class="mt-4" aria-label="Paginación de productos">
      <ul id="pagination" class="pagination justify-content-center"></ul>
    </nav>
  </div>
</section>


<template id="productTemplate">
  <div class="col-12 col-sm-6 col-lg-4 col-xl-3">
    <div class="card card-product h-100 border-0 shadow-sm">
      <div class="position-absolute top-0 start-0 m-2 d-flex gap-1"></div>
      <img class="card-img-top" alt="Producto" loading="lazy" />
      <div class="card-body">
        <div class="d-flex justify-content-between align-items-start mb-2">
          <h6 class="card-title"></h6>
          <small class="text-secondary"></small>
        </div>
        <p class="card-text text-secondary small"></p>
        <div class="d-flex justify-content-between align-items-center">
          <div>
            <div class="fw-bold price"></div>
            <div class="rating small"></div>
          </div>
          <button class="btn btn-primary btn-sm"><i class="bi bi-cart-plus"></i></button>
        </div>
      </div>
    </div>
  </div>
</template>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
  const PRODUCTS = [
    { id:1, title:"Laptop Pro 14" , brand:"ASUS", category:"laptop", ram:"16GB", price:24999, desc:"Ryzen 7 · 512GB SSD · OLED 90Hz", img:"https://picsum.photos/seed/lap1/600/400", tags:["new"], rating:4.7 },
    { id:2, title:"Laptop Ultra 15", brand:"Lenovo", category:"laptop", ram:"8GB", price:14999, desc:"Core i5 · 256GB SSD · IPS", img:"https://picsum.photos/seed/lap2/600/400", tags:["off"], rating:4.4 },
    { id:3, title:"Monitor 27'' QHD 165Hz", brand:"MSI", category:"monitores", ram:"", price:6999, desc:"VA Curvo · Adaptive Sync", img:"https://picsum.photos/seed/mon1/600/400", tags:["new"], rating:4.6 },
    { id:4, title:"SSD NVMe 1TB Gen4", brand:"HP", category:"almacenamiento", ram:"", price:1799, desc:"Hasta 5000 MB/s", img:"https://picsum.photos/seed/ssd1/600/400", tags:[], rating:4.8 },
    { id:5, title:"Desktop Creator i7", brand:"ASUS", category:"desktop", ram:"32GB", price:38999, desc:"i7 12ª · RTX 4060 · 1TB SSD", img:"https://picsum.photos/seed/desk1/600/400", tags:["off"], rating:4.9 },
    { id:6, title:"Teclado Mecánico RGB", brand:"Acer", category:"perifericos", ram:"", price:999, desc:"Switch rojo · 61 teclas", img:"https://picsum.photos/seed/key1/600/400", tags:[], rating:4.5 },
    { id:7, title:"GPU GeForce RTX 4070", brand:"MSI", category:"componentes", ram:"", price:12999, desc:"12GB GDDR6X · DLSS 3", img:"https://picsum.photos/seed/gpu1/600/400", tags:["new"], rating:4.9 },
    { id:8, title:"Mouse Inalámbrico Pro", brand:"HP", category:"perifericos", ram:"", price:799, desc:"Bluetooth 5.1 · 16000 DPI", img:"https://picsum.photos/seed/mou1/600/400", tags:[], rating:4.3 },
  ];

  const state = { page: 1, perPage: 8 };
  const $ = s => document.querySelector(s);
  const money = n => n.toLocaleString('es-MX',{style:'currency',currency:'MXN'});

  // 🔥 NUEVO: carrito
  const cart = [];

  function renderCart() {
    const cartCount = document.querySelector("#cartCount");
    if (cartCount) cartCount.textContent = cart.length;
    renderCartItems();
  }

  function renderCartItems() {
    const cartItemsContainer = document.querySelector("#cartItemsContainer");
    const cartTotalElement = document.querySelector("#cartTotal");
    let total = 0;
    
    cartItemsContainer.innerHTML = ''; // Limpiar elementos previos

    if (cart.length === 0) {
      cartItemsContainer.innerHTML = '<p class="text-center text-muted mt-5">El carrito está vacío 😔</p>';
    } else {
      cart.forEach(item => {
        const itemElement = document.createElement('div');
        itemElement.className = 'd-flex align-items-center mb-3';
        itemElement.innerHTML = `
          <img src="${item.img}" alt="${item.title}" class="rounded me-3" style="width: 60px; height: 60px; object-fit: cover;">
          <div class="flex-grow-1">
            <h6 class="mb-0">${item.title}</h6>
            <small class="text-secondary">${item.brand}</small>
          </div>
          <div class="fw-bold">${money(item.price)}</div>
        `;
        cartItemsContainer.appendChild(itemElement);
        total += item.price;
      });
    }
    
    cartTotalElement.textContent = money(total);
  }

  function setupCartButtons() {
    const grid = document.querySelector("#productsGrid");
    grid.querySelectorAll(".btn").forEach((btn, idx) => {
      btn.addEventListener("click", () => {
        const product = PRODUCTS[(state.page - 1) * state.perPage + idx];
        cart.push(product);
        renderCart();
      });
    });
  }

  function setupClearCartButton() {
    const clearBtn = document.querySelector("#clearCartBtn");
    if (clearBtn) {
      clearBtn.addEventListener("click", () => {
        cart.length = 0;
        renderCart();
      });
    }
  }

  function addCartUI() {
    const container = document.querySelector("#cartBarContainer");

    const cartBar = document.createElement("div");
    cartBar.className = "d-flex justify-content-between align-items-center mb-4";

    const info = document.createElement("h5");
    info.innerHTML = `🛒 Carrito (<span id="cartCount">0</span>)`;

    const clearBtn = document.createElement("button");
    clearBtn.className = "btn btn-danger btn-sm";
    clearBtn.innerHTML = `<i class="bi bi-trash"></i> Vaciar carrito`;

    clearBtn.addEventListener("click", () => {
      cart.length = 0;
      renderCart();
    });

    cartBar.appendChild(info);
    cartBar.appendChild(clearBtn);
    container.appendChild(cartBar);
  }

  function renderProducts(){
    const grid = $('#productsGrid');
    grid.innerHTML = '';

    const total = PRODUCTS.length;
    const totalPages = Math.max(1, Math.ceil(total / state.perPage));
    if(state.page > totalPages) state.page = 1;
    const start = (state.page - 1) * state.perPage;
    const end = start + state.perPage;
    const pageItems = PRODUCTS.slice(start, end);

    $('#resultsCount').textContent = total;

    const tpl = $('#productTemplate');
    pageItems.forEach(p => {
      const node = tpl.content.cloneNode(true);
      node.querySelector('img').src = p.img;
      node.querySelector('img').alt = p.title;
      node.querySelector('.card-title').textContent = p.title;
      node.querySelector('.card-text').textContent = p.desc;
      node.querySelector('.price').textContent = money(p.price);
      node.querySelector('small').textContent = p.brand;

      const badgeBox = node.querySelector('.position-absolute');
      if(p.tags.includes('new')){
        const b = document.createElement('span');
        b.className='badge badge-new text-white rounded-pill';
        b.textContent='Nuevo';
        badgeBox.appendChild(b);
      }
      if(p.tags.includes('off')){
        const b = document.createElement('span');
        b.className='badge badge-off text-white rounded-pill';
        b.textContent='Oferta';
        badgeBox.appendChild(b);
      }

      const r = node.querySelector('.rating');
      const full = Math.floor(p.rating);
      const half = p.rating - full >= 0.5;
      for(let i=0;i<full;i++){ r.innerHTML += '<i class="bi bi-star-fill"></i>'; }
      if(half) r.innerHTML += '<i class="bi bi-star-half"></i>';
      for(let i=(half?full+1:full); i<5; i++){ r.innerHTML += '<i class="bi bi-star"></i>'; }

      grid.appendChild(node);
    });

    renderPagination(totalPages);

    // 🔥 Activar botones de carrito cada vez que se pintan productos
    setupCartButtons();
  }

  function renderPagination(totalPages){
    const pag = $('#pagination');
    pag.innerHTML = '';
    const mk = (label, page, disabled=false, active=false) => {
      const li = document.createElement('li');
      li.className = 'page-item' + (disabled? ' disabled':'') + (active? ' active':'');
      const a = document.createElement('a');
      a.className = 'page-link'; a.href = '#'; a.textContent = label;
      a.addEventListener('click', (e)=>{ 
        e.preventDefault(); 
        if(!disabled){ state.page = page; renderProducts(); window.scrollTo({top:0,behavior:'smooth'}); } 
      });
      li.appendChild(a); return li;
    };
    pag.appendChild(mk('«', Math.max(1, state.page-1), state.page===1));
    for(let i=1; i<=totalPages; i++) pag.appendChild(mk(i, i, false, i===state.page));
    pag.appendChild(mk('»', Math.min(totalPages, state.page+1), state.page===totalPages));
  }

  document.addEventListener('DOMContentLoaded', () => {
    addCartUI();
    renderProducts();
    setupClearCartButton();
  });
</script>

</body>
</html>